title Place Component

participant OtherClients
participant Client
participant Server
participant Game
participant Board
participant Player
participant Spaceship
participant BuildingBoard

alt PlaceHandComponentAndPickHiddenComponent
  Client->Server:PlaceHandComponentAndPickVisibleComponentMessage(x,y,r)
  Server->Player: player
  Player->Spaceship: getSpaceship()
  Spaceship->BuildingBoard:getBuildingBoard()
  
  BuildingBoard->BuildingBoard: placeComponent(y,x,r)
  
  alt PlacedComponent
    BuildingBoard->Component: getImgSrc()
    Server<-BuildingBoard:
    OtherClients<-Server: sendMessageToOtherPlayersInGame(name, x, y, r, imgSrc)
    Server->Game: PickHiddenComponent(player)
    Game->Game: remove(randomPos)
    Game->Player:
    Player->Spaceship:getSpaceship()
    Spaceship->BuildingBoard:getBuildingBoard()
    BuildingBoard->BuildingBoard: setHandComponent(pickedComponent)

    Server->Client: PickedComponentMessage(imgSrcComponent)
  else ImpossiblePlaceComponent
    Server<-BuildingBoard:
    Client<-Server: "ImpossiblePlaceComponent"
  end


else PlaceHandComponentAndPickVisibleComponent
    
  Client->Server:PlaceHandComponentAndPickVisibleComponentMessage(x,y,r)
  Server->Player: player
  Player->Spaceship: getSpaceship()
  Spaceship->BuildingBoard:getBuildingBoard()
 
  BuildingBoard->BuildingBoard: placeComponent(y,x,r)
  
  alt PlacedComponent
    BuildingBoard->Component: getImgSrc()
    Server<-BuildingBoard:
    OtherClients<-Server: sendMessageToOtherPlayersInGame(name, x, y, r, imgSrc)
    Server->Game: PickVisibleComponent(player, idxVisibleComponent)
    Game->Game: remove(idxVisibleComponent)
    Game->Player:
    Player->Spaceship:getSpaceship()
    Spaceship->BuildingBoard:getBuildingBoard()
    BuildingBoard->BuildingBoard: setHandComponent(pickedComponent)
  
    Server->Client: PickedComponentMessage(imgSrcComponent)
  else ImpossiblePlaceComponent
    Server<-BuildingBoard:
    Client<-Server: "ImpossiblePlaceComponent"
  end

else PlaceHandComponentAndShowEventCard

  Client->Server:PlaceHandComponentAndShowEventCardMessage(x,y,r)

  Client->Server:Rotation(r)
end
space
note over Client, Server: Player decides to place the current component in a specic cell on the matrix.\nClient sends in first component's coordinates, then its rotation.\nServer will answer with a success/fail response.